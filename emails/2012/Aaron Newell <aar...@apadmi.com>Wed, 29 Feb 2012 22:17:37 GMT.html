<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Why does my mojo run twice with an @execute?</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201203.mbox/%3cweb-153444689@controller.cgpmail.ua.pt%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cCAJkOstQEbMpuWrMzUh1RWg7s2ZjfxL0ivUsR4iFTw21-kpM6hg@mail.gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201203.mbox/%3cweb-153444689@controller.cgpmail.ua.pt%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cCAJkOstQEbMpuWrMzUh1RWg7s2ZjfxL0ivUsR4iFTw21-kpM6hg@mail.gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201203.mbox/%3cweb-153444689@controller.cgpmail.ua.pt%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cCAJkOstQEbMpuWrMzUh1RWg7s2ZjfxL0ivUsR4iFTw21-kpM6hg@mail.gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201203.mbox/%3cweb-153444689@controller.cgpmail.ua.pt%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cCAJkOstQEbMpuWrMzUh1RWg7s2ZjfxL0ivUsR4iFTw21-kpM6hg@mail.gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Aaron Newell &lt;aar...@apadmi.com&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Why does my mojo run twice with an @execute?</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Wed, 29 Feb 2012 22:17:37 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
Hi, I have a mojo named 'forklifecycle' with the annotation

	@execute lifecycle="customlifecycle" phase="compile"

to fork a custom lifecycle which has a single other mojo in its compile
phase. When I run a project (mvn compile) with this plugin I get the
warning:

[WARNING] Removing: forklifecycle from forked lifecycle, to prevent
recursive invocation.

(in 2.0. In 3.x I get no warning, but it seems its still trying to run the
forklifecycle mojo twice).

I'm not sure why this the 'forklifecycle' goal is attempting to be run
twice, only to be removed to prevent recursion.

Could anyone tell me why the recursion is occurring?

--

My plugin project is:

pom.xml:
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;testgroup&lt;/groupId&gt;
  &lt;artifactId&gt;some_plugin&lt;/artifactId&gt;
  &lt;packaging&gt;maven-plugin&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;some_plugin Maven Mojo&lt;/name&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.maven&lt;/groupId&gt;
      &lt;artifactId&gt;maven-plugin-api&lt;/artifactId&gt;
      &lt;version&gt;2.0&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
&lt;/project&gt;


My plugins:
/**
 * @goal forklifecycle
 * @execute lifecycle="customlifecycle" phase="compile"
 */
public class TestForkMojo extends AbstractMojo {
	public void execute() throws MojoExecutionException, MojoFailureException
{
		getLog().info("--&gt; Fork cycle ran");
	}
}

/**
 * @goal test
 */
public class TestMojo extends AbstractMojo {
	public void execute() throws MojoExecutionException, MojoFailureException
{
		getLog().info("--&gt; Test mojo ran.");
	}
}

My lifecycle:
&lt;lifecycles&gt;
  &lt;lifecycle&gt;
	&lt;id&gt;customlifecycle&lt;/id&gt;
	&lt;phases&gt;
		&lt;phase&gt;
			&lt;id&gt;compile&lt;/id&gt;
			&lt;executions&gt;
				&lt;execution&gt;
				  &lt;goals&gt;
				    &lt;goal&gt;test&lt;/goal&gt;
				  &lt;/goals&gt;     
				&lt;/execution&gt;
			&lt;/executions&gt;
		&lt;/phase&gt;
	&lt;/phases&gt;
  &lt;/lifecycle&gt;
&lt;/lifecycles&gt;


The project that runs this is:

&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
http://maven.apache.org/maven-v4_0_0.xsd"&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;testgrouptwo&lt;/groupId&gt;
  &lt;artifactId&gt;a_test&lt;/artifactId&gt;
  &lt;packaging&gt;pom&lt;/packaging&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;another_test&lt;/name&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;testgroup&lt;/groupId&gt;
        &lt;artifactId&gt;some_plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;compile&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;forklifecycle&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;












---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201203.mbox/raw/%3cCB745478.2B69%25aaronn@apadmi.com%3e/">Unnamed text/plain</a> (inline, Quoted Printable, 3116 bytes)</li>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201203.mbox/raw/%3cCB745478.2B69%25aaronn@apadmi.com%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
