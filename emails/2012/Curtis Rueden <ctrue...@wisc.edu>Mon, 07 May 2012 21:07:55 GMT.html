<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Re: Reducing SNAPSHOT redundancy</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201205.mbox/%3cCAKDUN1s3CCtZ58Ec3NHN9YNvb_Niud_7wacjmy6wGoXZRpBgbg@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201205.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201205.mbox/%3cCALy+7UkgPX4rDzHnimNeuiW=k8RX8vDdSEE44YmHFkySj3ahkg@mail.gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201205.mbox/%3cCAKDUN1s3CCtZ58Ec3NHN9YNvb_Niud_7wacjmy6wGoXZRpBgbg@mail.gmail.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201205.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201205.mbox/%3cCAG8spyg6zORKPsdwOOuYeE2S0Tod4BCescvNMwYZWzurTAJsCQ@mail.gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201205.mbox/%3cCAKDUN1s3CCtZ58Ec3NHN9YNvb_Niud_7wacjmy6wGoXZRpBgbg@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201205.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201205.mbox/%3cCALy+7UkgPX4rDzHnimNeuiW=k8RX8vDdSEE44YmHFkySj3ahkg@mail.gmail.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201205.mbox/%3cCAKDUN1s3CCtZ58Ec3NHN9YNvb_Niud_7wacjmy6wGoXZRpBgbg@mail.gmail.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201205.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201205.mbox/%3cCAG8spyg6zORKPsdwOOuYeE2S0Tod4BCescvNMwYZWzurTAJsCQ@mail.gmail.com%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Curtis Rueden &lt;ctrue...@wisc.edu&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Re: Reducing SNAPSHOT redundancy</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Mon, 07 May 2012 21:07:55 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
Hi Anders,

Thanks for your reply.


&gt; I believe the common way to handle this is to schedule purging of old
&gt; snapshots in the repo manager. At least that's how I handle it in my
&gt; setups.
&gt;

Indeed, our Nexus is set to purge old snapshots daily, deleting any that
are more than 7 days old. This works just fine.

This is very helpful since it effectively bounds the disk space requirement
based on the number of builds that happen in a 7-day window.

However, my concern is more regarding the fact that the snapshot binaries
"cycle" all the time. That is, they are being continually replaced with new
builds, which may in fact be based on identical source code, every time
someone pushes to the Git repository. The unfortunate side effect is that
all developers on the project generally have to redownload all submodule
JARs once every 24 hours (whenever Maven snapshots are refreshed).

Regards,
Curtis


On Mon, May 7, 2012 at 3:53 PM, Anders Hammar &lt;anders@hammar.net&gt; wrote:

&gt; I believe the common way to handle this is to schedule purging of old
&gt; snapshots in the repo manager. At least that's how I handle it in my
&gt; setups.
&gt;
&gt; /Anders
&gt;
&gt; On Mon, May 7, 2012 at 10:31 PM, Curtis Rueden &lt;ctrueden@wisc.edu&gt; wrote:
&gt; &gt; Hi everyone,
&gt; &gt;
&gt; &gt; I have a question about snapshot deployment.
&gt; &gt;
&gt; &gt; I have a multi-module project with ~30 modules, all in a Git repository
&gt; on
&gt; &gt; GitHub. Whenever someone pushes to the repository, a GitHub notification
&gt; &gt; hook pings our Jenkins to do a rebuild, which includes a redeploy to our
&gt; &gt; Nexus. This is all great.
&gt; &gt;
&gt; &gt; However, there is a lot of redundancy between snapshot JAR files. Often,
&gt; a
&gt; &gt; commit will involve only one of the 30 submodules, but all 30 will
&gt; &gt; ultimately be rebuilt and redeployed, resulting in a plethora of snapshot
&gt; &gt; versions. At any point in time, there is nearly always a "new" version of
&gt; &gt; any given submodule of the project.
&gt; &gt;
&gt; &gt; I was wondering about the best way to reduce this issue. It would be nice
&gt; &gt; to only redeploy snapshots that have actually changed—or better, for
&gt; Maven
&gt; &gt; (client-side) or Nexus (server-side) to detect identical snapshots and
&gt; not
&gt; &gt; waste the space creating a superfluous new one. (Of course, for a variety
&gt; &gt; of reasons, comparing binary hashes between the latest snapshot JAR and
&gt; the
&gt; &gt; new snapshot candidate may not be enough—especially if the build process
&gt; or
&gt; &gt; CI adds some build-specific information to the JAR. But that is not
&gt; really
&gt; &gt; Maven's problem...)
&gt; &gt;
&gt; &gt; Alternately, we could do something on the CI side to only do the deploy
&gt; if
&gt; &gt; the submodule is really known to have changed—probably involving git
&gt; &gt; reflogs etc. But that road could quickly become fraught with peril...
&gt; &gt;
&gt; &gt; So my question is: is there a common Maven best practice to mitigate such
&gt; &gt; redundancy? Or do most people simply live with the proliferation of
&gt; &gt; snapshots that occurs when using a naive deployment scheme?
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt; Curtis
&gt;
&gt; ---------------------------------------------------------------------
&gt; To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
&gt; For additional commands, e-mail: users-help@maven.apache.org
&gt;
&gt;

</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li>Unnamed multipart/alternative (inline, None, 0 bytes)</li>
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201205.mbox/raw/%3cCADN69y=sb6W2Xt0pY6PyqfUctawAVPH85ffSR-wEthtHWOTWaQ@mail.gmail.com%3e/1">Unnamed text/plain</a> (inline, Quoted Printable, 3211 bytes)</li>
</ul>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201205.mbox/raw/%3cCADN69y=sb6W2Xt0pY6PyqfUctawAVPH85ffSR-wEthtHWOTWaQ@mail.gmail.com%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
