<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Running surefire:test goal uses wrong resource file</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201203.mbox/%3cCALy+7U=jEVUZir2JP1cpVw+x_PK2QJxNHV6j1nJ8uSVCjYC3UA@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cABB151421EA480408FE016CFB8E1AAF03980B347D0@exchange1.exchange.themis.ag.gov.bc.ca%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201203.mbox/%3c1333031103515-5603961.post@n5.nabble.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cABB151421EA480408FE016CFB8E1AAF03980B347D0@exchange1.exchange.themis.ag.gov.bc.ca%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201203.mbox/%3cCALy+7U=jEVUZir2JP1cpVw+x_PK2QJxNHV6j1nJ8uSVCjYC3UA@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cABB151421EA480408FE016CFB8E1AAF03980B347D0@exchange1.exchange.themis.ag.gov.bc.ca%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201203.mbox/%3c1333031103515-5603961.post@n5.nabble.com%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201203.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201203.mbox/%3cABB151421EA480408FE016CFB8E1AAF03980B347D0@exchange1.exchange.themis.ag.gov.bc.ca%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Amir Gheibi &lt;aghe...@fmep.ag.gov.bc.ca&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Running surefire:test goal uses wrong resource file</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Thu, 29 Mar 2012 22:48:58 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
Using Maven 3.0.4 with a flat project structure:

|--Parent
|  |____ pom.xml
|
|--Module
| |____ pom.xml
|

I use JPA for persistence and my unit test code uses different persistence configuration file
than the main source. I use an in-memory derby database for unit tests and the actual source
uses an Oracle database. However, running "mvn clean test" updates the oracle database. It
seems surefire's test goal uses the wrong resource file.


Persistence.xml used by unit tests which is located under "Module/src/test/resources/META-INF"

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
       version="2.0"&gt;
       &lt;persistence-unit name="xxx" transaction-type="RESOURCE_LOCAL"&gt;
              &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;
              &lt;class&gt;com.domain.someProject.SomeEntity&lt;/class&gt;
              &lt;properties&gt;
                     &lt;property name="eclipselink.target-database" value="DERBY" /&gt;
                     &lt;property name="eclipselink.ddl-generation" value="drop-and-create-tables"
/&gt;
                     &lt;property name="eclipselink.logging.level" value="FINE" /&gt;
                     &lt;property name="javax.persistence.jdbc.driver" value="org.apache.derby.jdbc.EmbeddedDriver"
/&gt;
                     &lt;property name="javax.persistence.jdbc.url" value="jdbc:derby:memory:testDB;create=true"
/&gt;
                     &lt;property name="javax.persistence.jdbc.user" value="APP" /&gt;
                     &lt;property name="javax.persistence.jdbc.password" value="APP" /&gt;
              &lt;/properties&gt;
       &lt;/persistence-unit&gt;
&lt;/persistence&gt;



Persistence.xml used by main source which is located under "Module/src/main/resources/META-INF"

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
       version="2.0"&gt;
       &lt;persistence-unit name="xxx" transaction-type="RESOURCE_LOCAL"&gt;
              &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;
              &lt;class&gt;com.domain.someProject.SomeEntity&lt;/class&gt;
              &lt;properties&gt;
                     &lt;property name="eclipselink.target-database" value="Oracle" /&gt;
                     &lt;property name="eclipselink.logging.level" value="INFO" /&gt;
                     &lt;property name="javax.persistence.jdbc.driver" value="oracle.jdbc.OracleDriver"
/&gt;
                     &lt;property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin:@yyy:1634:XE"
/&gt;
                     &lt;property name="javax.persistence.jdbc.user" value="usr" /&gt;
                     &lt;property name="javax.persistence.jdbc.password" value="pass" /&gt;
              &lt;/properties&gt;
       &lt;/persistence-unit&gt;
&lt;/persistence&gt;


Would appreciate any input.

- Amir

</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li>Unnamed multipart/alternative (inline, None, 0 bytes)</li>
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201203.mbox/raw/%3cABB151421EA480408FE016CFB8E1AAF03980B347CD@exchange1.exchange.themis.ag.gov.bc.ca%3e/1">Unnamed text/plain</a> (inline, Quoted Printable, 3254 bytes)</li>
</ul>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201203.mbox/raw/%3cABB151421EA480408FE016CFB8E1AAF03980B347CD@exchange1.exchange.themis.ag.gov.bc.ca%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
