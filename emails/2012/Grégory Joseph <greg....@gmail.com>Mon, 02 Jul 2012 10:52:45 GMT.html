<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Site, deployment url and inheritance</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201207.mbox/%3cCACpkv-ymrK8FkfwDsL17U5BrNXQ0rTYZO7JT1FjHxrN=qpFU=A@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201207.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201207.mbox/%3c4FF18393.5070208@apache.org%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201207.mbox/%3cSNT143-W18C15DB2DE096089F7874B1EB0@phx.gbl%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201207.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201207.mbox/%3c4FF18393.5070208@apache.org%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201207.mbox/%3cCACpkv-ymrK8FkfwDsL17U5BrNXQ0rTYZO7JT1FjHxrN=qpFU=A@mail.gmail.com%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201207.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201207.mbox/%3c4FF18393.5070208@apache.org%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201207.mbox/%3cSNT143-W18C15DB2DE096089F7874B1EB0@phx.gbl%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201207.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201207.mbox/%3c4FF18393.5070208@apache.org%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Gr√©gory Joseph &lt;greg....@gmail.com&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Site, deployment url and inheritance</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Mon, 02 Jul 2012 10:52:45 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
Hi there,

I've seen this "topic" debated many times, and still haven't figured
everything out. I was recently confused by the handling and
inheritance of urls in Maven. I think I got most of it, when it comes
to project.url.

Now, when it comes to deploying a site, I'm baffled. Up to
maven-site-plugin 2.1.1, things seem to be fairly understandable. It
wasn't exactly possible (at least to my understanding) to have
multi-module projects sites deployed in a "versioned" directory
(because ${artifactId}/${version} would be re-interpolated for every
submodule). But at least, I could do a help:effective-pom, and get the
URLs that would be used for deployment.

Now I just tried 3.1, and I'm baffled that I can't seem to be able to
completely override the distributionManagement.site.url defined by my
parent pom. Using help:effective-pom gives me the URLs I expect, and
the ones i would like Maven to use when deploying the site. However,
the plugin seems to think differently, and tries to upload to
"relativised" urls, somehow inheriting the site url defined in a
corporate parent pom, adding some levels of "../" and finally the path
i'm expecting.

It kind of sounds like MSITE-600 to me, so I'm unsure if/how the issue
was fixed. Example:
* Corporate parent pom defines this site deployment url:
prot://foo/${artifactId}/${version} -- it works for this pom, and it's
a good enough default for most of our single-module projects. Not the
lack of trailing slash, btw.
* Some multi-module project defines this site deployment url:
prot://foo/xuq/lolcats/${version}. And the resulting deployment urls
end up looking like:
prot://foo/corp-parent/12//../../xuq/lolcats/${version} (and I still
don't know where the double slash comes from)

So unlike one of the latest comments in MSITE-600, I'm not even trying
to change the protocol. But it seems that either the wagon (i'm using
dav, if that's relevant), or the Nexus instance I have at the
receiving end, don't cope well with those "../".

Question is two fold:
* Why is the plugin even trying to do that ? Why is it not following
the same rules as effective-pom ? How can one "preview" what urls will
be used, then ?
* How do people really deploy sites with a version number in the path,
when using a "corporate" parent pom, without redefining the site.url
for every single project ?

Thanks for any hint or tip !

Cheers,
-greg

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201207.mbox/raw/%3cCACxOcRoJf8WhWaq0BQNfk4BD3jZQt4wFwOm6vTqJnPa9B3Q8=g@mail.gmail.com%3e/">Unnamed text/plain</a> (inline, None, 2577 bytes)</li>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201207.mbox/raw/%3cCACxOcRoJf8WhWaq0BQNfk4BD3jZQt4wFwOm6vTqJnPa9B3Q8=g@mail.gmail.com%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
