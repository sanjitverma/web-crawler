<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Re: maven-rpm-plugin executes scripts to include during build</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201204.mbox/%3c4F97B7A2.1070307@wennysoft.de%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201204.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201204.mbox/%3c1335344099944-5664251.post@n5.nabble.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201204.mbox/%3c4F97B7A2.1070307@wennysoft.de%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201204.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201204.mbox/%3c4F97D4D5.2010208@wennysoft.de%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201204.mbox/%3c4F97B7A2.1070307@wennysoft.de%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201204.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201204.mbox/%3c1335344099944-5664251.post@n5.nabble.com%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201204.mbox/%3c4F97B7A2.1070307@wennysoft.de%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201204.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201204.mbox/%3c4F97D4D5.2010208@wennysoft.de%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Anders Hammar &lt;and...@hammar.net&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">Re: maven-rpm-plugin executes scripts to include during build</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Wed, 25 Apr 2012 08:45:12 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
I'm somewhat guessing here, but I think you want to use one of the
install scriptlets:
http://mojo.codehaus.org/rpm-maven-plugin/adv-params.html#Scripts

The "prepareScriptlet" is for preparing the rpm build, whcih you've
noticed is not what you want.

/Anders

On Wed, Apr 25, 2012 at 10:36, Maven &lt;maven@wennysoft.de&gt; wrote:
&gt; Hi all,
&gt;
&gt; I have some problems using the maven-rpm-plugin. I want to include some
&gt; scripts to be executed but these get executed during the build (preventing a
&gt; successfull build because of permissions).
&gt;
&gt; The question now is how can I include scripts which will NOT execute during
&gt; build but gets executed during rpm -i
&gt;
&gt; Here is my setup:
&gt;
&gt; I have a java application (daemon) which is build by maven and packaged into
&gt; an rpm using the maven-rpm-plugin.
&gt;
&gt; I added a script to automatically start the daemon (by
&gt; calling/etc/init.d/..)
&gt;
&gt; Now I get errors from our build-server as this gets executed on the
&gt; BUILD-Server (and is intended to only run on the destination machine where
&gt; the rpm will be installed)
&gt;
&gt; below is the used configuration:
&gt;
&gt; &lt;plugin&gt;
&gt;  &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
&gt;  &lt;artifactId&gt;rpm-maven-plugin&lt;/artifactId&gt;
&gt;  &lt;version&gt;2.1-alpha-1&lt;/version&gt;
&gt;  &lt;extensions&gt;true&lt;/extensions&gt;
&gt;  &lt;configuration&gt;
&gt;    &lt;group&gt;${project.groupId}&lt;/group&gt;
&gt;    &lt;name&gt;deployAgent&lt;/name&gt;
&gt;    &lt;projversion&gt;${project.version}&lt;/projversion&gt;
&gt;    &lt;autoRequires&gt;false&lt;/autoRequires&gt;  &lt;!-- reines JAVA --&gt;
&gt;    &lt;defaultFileMode&gt;644&lt;/defaultFileMode&gt;
&gt;    &lt;defaultDirMode&gt;755&lt;/defaultDirMode&gt;
&gt;    &lt;defaultUsername&gt;deployment&lt;/defaultUsername&gt;
&gt;    &lt;defaultGroupname&gt;root&lt;/defaultGroupname&gt;
&gt;    &lt;requires&gt;
&gt;      &lt;require&gt;internal-Java&amp;gt;= 1.6&lt;/require&gt;
&gt;    &lt;/requires&gt;
&gt;    &lt;mappings&gt;
&gt;         ....
&gt;    &lt;/mappings&gt;
&gt;    &lt;postinstall&gt;
&gt;      ln -fs /infrastructure/deployment/deployAgent/bin/startstop.sh
&gt; /etc/init.d/deployAgent
&gt;      chown root ${userconf.dstRoot}
&gt;      chmod 0750 ${userconf.dstRoot}
&gt;      /etc/init.d/deployAgent start
&gt;    &lt;/postinstall&gt;
&gt;    &lt;prepareScriptlet&gt;
&gt;      &lt;script&gt;
&gt;        /etc/init.d/deployAgent stop
&gt;      &lt;/script&gt;
&gt;    &lt;/prepareScriptlet&gt;
&gt;  &lt;/configuration&gt;
&gt; &lt;/plugin&gt;
&gt;
&gt; The problem occurs in the prepareScriptlet which gets executed during build
&gt; and failing because of missing permissions to do something in /etc/init.d on
&gt; the build-server (which is correct as this does not make any sense there).
&gt;
&gt; What do I have to do to execute this command during rpm-install/rpm-update
&gt; but not during build?
&gt;

---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201204.mbox/raw/%3cCAKDUN1vTnrA8wSoEy_zN6HfFqPpqsM89qi-3Ta+5p9T-6w=0nw@mail.gmail.com%3e/">Unnamed text/plain</a> (inline, Quoted Printable, 2864 bytes)</li>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201204.mbox/raw/%3cCAKDUN1vTnrA8wSoEy_zN6HfFqPpqsM89qi-3Ta+5p9T-6w=0nw@mail.gmail.com%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
