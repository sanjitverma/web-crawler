<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>RE: AW: Find the correct build order of a set of distinct butinterdependent projects</title>
  <link rel="stylesheet" type="text/css" href="/archives/style.css" />
 </head>

 <body id="archives">
  <h1>maven-users mailing list archives</h1>

  <h5>
<a href="http://mail-archives.apache.org/mod_mbox/" title="Back to the archives depot">Site index</a> &middot; <a href="/mod_mbox/maven-users" title="Back to the list index">List index</a></h5>  <table class="static" id="msgview">
   <thead>
    <tr>
    <th class="title">Message view</th>
    <th class="nav"><a href="/mod_mbox/maven-users/201603.mbox/%3c228392243295456.DA29A3396A@apache.org%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201603.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201603.mbox/%3cBLU172-W490D3EBA6A9FDA4C088B22AE830@phx.gbl%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201603.mbox/%3c2936fa7b04633e474972accd2742d521@dag.cloud%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201603.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201603.mbox/%3cBLU172-W490D3EBA6A9FDA4C088B22AE830@phx.gbl%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </thead>

   <tfoot>
    <tr>
    <th class="title"><a href="#archives">Top</a></th>
    <th class="nav"><a href="/mod_mbox/maven-users/201603.mbox/%3c228392243295456.DA29A3396A@apache.org%3e" title="Previous by date">&laquo;</a> <a href="/mod_mbox/maven-users/201603.mbox/date" title="View messages sorted by date">Date</a> <a href="/mod_mbox/maven-users/201603.mbox/%3cBLU172-W490D3EBA6A9FDA4C088B22AE830@phx.gbl%3e" title="Next by date">&raquo;</a> &middot; <a href="/mod_mbox/maven-users/201603.mbox/%3c2936fa7b04633e474972accd2742d521@dag.cloud%3e" title="Previous by thread">&laquo;</a> <a href="/mod_mbox/maven-users/201603.mbox/thread" title="View messages sorted by thread">Thread</a> <a href="/mod_mbox/maven-users/201603.mbox/%3cBLU172-W490D3EBA6A9FDA4C088B22AE830@phx.gbl%3e" title="Next by thread">&raquo;</a></th>
   </tr>
   </tfoot>

   <tbody>
   <tr class="from">
    <td class="left">From</td>
    <td class="right">Christophe Thiebaud &lt;christophe.thieb...@dag.cloud&gt;</td>
   </tr>
   <tr class="subject">
    <td class="left">Subject</td>
    <td class="right">RE: AW: Find the correct build order of a set of distinct butinterdependent projects</td>
   </tr>
   <tr class="date">
    <td class="left">Date</td>
    <td class="right">Fri, 25 Mar 2016 11:28:37 GMT</td>
   </tr>
   <tr class="contents"><td colspan="2"><pre>
On 2016-03-22 22:24, Christophe Thiebaud wrote:

Hi all,

for those interested, I stumbled on a (natural) defect with the approach 
"#2 "super" multi-module pom" (cf. 
http://dag.cloud/docs/theproblem.html)

e.g.

let A and B be 2 projects that need ordering

let A be itself a multi-module project with sub-modules A1 and A2

dependencies are as follow :

A1 no dependency
B depends on A1
A2 depends on B
A2 depends on A1 as well, this is not required for the sake of the 
demonstration, but is the common real-life situation

+------------+
| A          |
|   +----+   |
|   | A1 &lt;---+----+
|   +--^-+   |    ^
|      ^     |  +-^-+
|      ^     |  | B |
|      ^     |  +-^-+
|   +--^--+  |    ^
|   | A2  &gt;--+----+
|   +-----+  |
+------------+

"super" multi-module pom will validate fine, no cycle: A1, then B, then 
A2

but a cycle exists between A and B projects. no ordering is possible

+------+
| A    |
|      &lt;----+
|      |    ^
|      |  +-^-+
|      |  | B |
|      |  +-^-+
|      |    ^
|      &gt;----+
+------+

this defect is not a really a blocker, but some cycle detection logic 
needs to be added somewhere in the global solution.

just FYI, thanks!
Christophe

&gt; On 2016-03-22 17:01, Martin Gainty wrote:
&gt; 
&gt; CT&gt;quick answers prefixed by CT&gt;
&gt; 
&gt;&gt; MG&gt;quick question prefixed by MG&gt;
&gt;&gt; 
&gt;&gt;&gt; Date: Tue, 22 Mar 2016 09:53:33 +0100
&gt;&gt;&gt; From: christophe.thiebaud@dag.cloud
&gt;&gt;&gt; To: users@maven.apache.org; dev@maven.apache.org
&gt;&gt;&gt; CC: ecki@zusammenkunft.net
&gt;&gt;&gt; Subject: Re: AW: Find the correct build order of a set of distinct 
&gt;&gt;&gt; butinterdependent projects
&gt;&gt;&gt; 
&gt;&gt;&gt; (sorry for the resend)
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi Bernd and Elliot,
&gt;&gt;&gt; 
&gt;&gt;&gt; thanks for the feedback. Happy to know from Elliot that "multi-module
&gt;&gt;&gt; pom generation" has been a viable solution for him. And I must
&gt;&gt;&gt; definitely have a look at how Jenkins Maven Jobs may fit in the
&gt;&gt;&gt; picture, as suggested by Bernd.
&gt;&gt;&gt; 
&gt;&gt;&gt; Hi maven developers,
&gt;&gt;&gt; 
&gt;&gt;&gt; I take the liberty to forward this thread to the developer list, in
&gt;&gt;&gt; the hope to get further insights from specialists.
&gt;&gt;&gt; 
&gt;&gt;&gt; quick summary is here : http://dag.cloud/docs/theproblem.html
&gt;&gt;&gt; 
&gt;&gt;&gt; Thanks!
&gt;&gt;&gt; Christophe
&gt;&gt;&gt; 
&gt;&gt;&gt; &gt; On 2016-03-16 00:21, Bernd Eckenfels wrote:
&gt;&gt;&gt; &gt;&gt; Hello,
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; It might not completely solve your problem (as it does not observe
&gt;&gt;&gt; &gt;&gt; versions) but with Jenkins Maven Jobs it builds dependent jobs
&gt;&gt;&gt; &gt;&gt; automatically.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; If you follow a release strategy it is however not something you need
&gt;&gt;&gt; &gt;&gt; in practice as you have to step through the dependencies to release
&gt;&gt;&gt; &gt;&gt; them anyway.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; And when your system matures and you start to refacture dependencies
&gt;&gt;&gt; &gt;&gt; they start to change over time.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Maybe stuffing all in a graph database would help you (jqassist.org).
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Gruss
&gt;&gt;&gt; &gt;&gt; Bernd
&gt;&gt;&gt; &gt;&gt; --
&gt;&gt;&gt; &gt;&gt; http://bernd.eckenfels.net
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Von: Elliot Metsger
&gt;&gt;&gt; &gt;&gt; Gesendet: Dienstag, 15. März 2016 23:27
&gt;&gt;&gt; &gt;&gt; An: Maven Users List
&gt;&gt;&gt; &gt;&gt; Betreff: Re: Find the correct build order of a set of distinct
&gt;&gt;&gt; &gt;&gt; butinterdependent projects
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Hi Christophe,
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; Just chiming in with my experience; we used to have a complex build,
&gt;&gt;&gt; &gt;&gt; and I
&gt;&gt;&gt; &gt;&gt; used approach #2.  I don't remember the total number of projects in
&gt;&gt;&gt; &gt;&gt; the
&gt;&gt;&gt; &gt;&gt; reactor (it was less than 100 for sure, but probably more than 20),
&gt;&gt;&gt; &gt;&gt; and
&gt;&gt;&gt; &gt;&gt; that worked fine.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; I wasn't aware of the Maven event spy approach.  That sounds like a
&gt;&gt;&gt; &gt;&gt; tidy,
&gt;&gt;&gt; &gt;&gt; albeit more technical, solution.  I don't think we were able to
&gt;&gt;&gt; &gt;&gt; successfully use the dependency plugin, but this was a few years ago
&gt;&gt;&gt; &gt;&gt; and
&gt;&gt;&gt; &gt;&gt; the plugin may have advanced since then.
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt; On Tue, Mar 15, 2016 at 4:17 PM, Christophe Thiebaud &lt;
&gt;&gt;&gt; &gt;&gt; christophe.thiebaud@dag.cloud&gt; wrote:
&gt;&gt;&gt; &gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; Hi all,
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; The problem is all in the title :
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; How to find the correct build order of a set of distinct but
&gt;&gt;&gt; &gt;&gt;&gt; interdependent projects.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; Distinct means that each project lives in its own source repository,
&gt;&gt;&gt; &gt;&gt;&gt; each
&gt;&gt;&gt; &gt;&gt;&gt; project build separately.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; Interdependent means that projects may be dependent upon each other.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; So the question is:
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt;    - which projects depends on which other projects?
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; in order to be able to build the projects still separately, but
in
&gt;&gt;&gt; &gt;&gt;&gt; the
&gt;&gt;&gt; &gt;&gt;&gt; correct order.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; e.g. slf4j and logback: which one depends on the other? Which one
do
&gt;&gt;&gt; &gt;&gt;&gt; I
&gt;&gt;&gt; &gt;&gt;&gt; need to build first?
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; I thought of the following four possible solutions, and I have
&gt;&gt;&gt; &gt;&gt;&gt; experience
&gt;&gt;&gt; &gt;&gt;&gt; with the first three:
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; 1. The poor man’s solution : hardcode the order
&gt;&gt;&gt; &gt;&gt;&gt; 2. Generate a multi-module pom file that contains all projects as
&gt;&gt;&gt; &gt;&gt;&gt; modules
&gt;&gt;&gt; &gt;&gt;&gt; 3. Collect build-time repository events with a maven event spy
&gt;&gt;&gt; &gt;&gt;&gt; 4. Collect pom file dependency information with the dependency plugin
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; to avoid a loooong mail, the options are further detailed here :
&gt;&gt;&gt; &gt;&gt;&gt; http://dag.cloud/docs/theproblem.html
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; This is so generic a problem that I am sure you've already been
faced
&gt;&gt;&gt; &gt;&gt;&gt; with.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; I'd be glad to get some piece of advice from the community.
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; For instance, is somebody aware of any existing open source toolset
&gt;&gt;&gt; &gt;&gt;&gt; around
&gt;&gt;&gt; &gt;&gt;&gt; this problem?
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; Concerning option #4, I am under the impression (from blurred
&gt;&gt;&gt; &gt;&gt;&gt; remember of
&gt;&gt;&gt; &gt;&gt;&gt; some mail exchanges on this list long time ago) that the
&gt;&gt;&gt; &gt;&gt;&gt; dependency-plugin
&gt;&gt;&gt; &gt;&gt;&gt; tree goal implementation is not congruent with the actual aether
&gt;&gt;&gt; &gt;&gt;&gt; implementation, which, if true, would be a show stopper. Can somebody
&gt;&gt;&gt; &gt;&gt;&gt; confirm/infirm ?
&gt;&gt; 
&gt;&gt; MG&gt;maven-dependency-plugin version 2.8 fixed the issue
&gt;&gt; MG&gt;https://issues.apache.org/jira/browse/MDEP-407
&gt; 
&gt; CT&gt; thanks for the info! So using dependency plugin for the task is 
&gt; safe.
&gt; 
&gt;&gt; MG&gt;please confirm
&gt; 
&gt; CT&gt; not sure to understand what I should confirm. I am investigating
&gt; the possible solutions and did not yet start anything with the
&gt; dependency plugin.
&gt; CT&gt; Furthermore, as I have now a rough on the edges but working
&gt; solution using a mix of super-pom with modules and event spy, I will
&gt; likely not start to implement the dependency plugin way.
&gt; 
&gt;&gt; MG Tangent&gt;curious why you need to combine eclipse and maven 
&gt;&gt; environments?
&gt; 
&gt; CT&gt; I do not need to combine eclipse and maven. I only remembered
&gt; there had been some issue, I did not remember the context.
&gt; CT&gt; I thank you for the clarification
&gt; 
&gt;&gt;&gt; &gt;&gt;&gt; Thanks!
&gt;&gt;&gt; &gt;&gt;&gt; Christophe
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt; ---------------------------------------------------------------------
&gt;&gt;&gt; &gt;&gt;&gt; To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
&gt;&gt;&gt; &gt;&gt;&gt; For additional commands, e-mail: users-help@maven.apache.org
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; &gt;&gt;&gt;
&gt;&gt;&gt; 
&gt;&gt;&gt; 
&gt;&gt;&gt; ---------------------------------------------------------------------
&gt;&gt;&gt; To unsubscribe, e-mail: dev-unsubscribe@maven.apache.org
&gt;&gt;&gt; For additional commands, e-mail: dev-help@maven.apache.org
&gt;&gt;&gt; 
&gt; 
&gt; 
&gt; ---------------------------------------------------------------------
&gt; To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
&gt; For additional commands, e-mail: users-help@maven.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: users-unsubscribe@maven.apache.org
For additional commands, e-mail: users-help@maven.apache.org


</pre></td></tr>
   <tr class="mime">
    <td class="left">Mime</td>
    <td class="right">
<ul>
<li><a rel="nofollow" href="/mod_mbox/maven-users/201603.mbox/raw/%3cba7ef7f406e4222bea4092c69cc8b275@dag.cloud%3e/">Unnamed text/plain</a> (inline, 8-Bit, 7498 bytes)</li>
</ul>
</td>
</tr>
   <tr class="raw">
    <td class="left"></td>
    <td class="right"><a href="/mod_mbox/maven-users/201603.mbox/raw/%3cba7ef7f406e4222bea4092c69cc8b275@dag.cloud%3e" rel="nofollow">View raw message</a></td>
   </tr>
   </tbody>
  </table>
 </body>
</html>
